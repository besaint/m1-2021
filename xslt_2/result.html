<html>
  <head>
    <title>Задание №2</title>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
      <h3>Результат(<a href="in.xml">ссылка</a>): </h3>
    <canvas id="canvas-0" width="640" height="480" > </canvas>

    <script>
      var canvas = document.getElementById("canvas-0");
      var context = canvas.getContext("2d");

      draw(context, 206, 139, 100, 100, "white", "rgba(255,0,0,0.5)");

      draw(context, 108, 111, 100, 100, "white", "rgba(0,0,255,0.5)");

      draw(context, 134, 215, 100, 100, "white", "rgba(0,255,0,0.5)");

      function draw(ctx, cx, cy, rx, ry, stroke, fill) {
        if (ctx.ellipse) {
          ctx.save();
          ctx.beginPath();
          ctx.ellipse(cx, cy, rx, ry, 0, 0, Math.PI * 2);
          ctx.strokeStyle = stroke;
          ctx.stroke();
          ctx.fillStyle = fill;
          ctx.fill();
          ctx.restore();
        }
      }
    </script>

    <div class="container">
      <div class="accordion" id="accordionExample">
        <div class="card">
          <div class="card-header" id="headingOne">
            <h2 class="mb-0">
              <button
                class="btn btn-link btn-block text-left"
                type="button"
                data-toggle="collapse"
                data-target="#collapseOne"
                aria-expanded="true"
                aria-controls="collapseOne"
              >
                Входной XML
              </button>
            </h2>
          </div>

          <div
            id="collapseOne"
            class="collapse"
            aria-labelledby="headingOne"
            data-parent="#accordionExample"
          >
            <div class="card-body">
<pre><code>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;?xml-stylesheet type="text/xsl" href="svg.xsl" ?&gt;
&lt;root&gt;
    &lt;графика ширина="640" высота="480"&gt;
        &lt;эллипс id="графика_1" заливка="rgba(255,0,0,0.5)" ободок="white" ширина-ободка="5" cx="206" cy="139" rx="100" ry="100"/&gt;
        &lt;эллипс id="графика_2" заливка="rgba(0,0,255,0.5)" ободок="white" ширина-ободка="5" cx="108" cy="111" rx="100" ry="100"/&gt;
        &lt;эллипс id="графика_3" заливка="rgba(0,255,0,0.5)" ободок="white" ширина-ободка="5" cx="134" cy="215" rx="100" ry="100"/&gt;
    &lt;/графика&gt;
&lt;/root&gt;
</code></pre>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-header" id="headingTwo">
            <h2 class="mb-0">
              <button
                class="btn btn-link btn-block text-left collapsed"
                type="button"
                data-toggle="collapse"
                data-target="#collapseTwo"
                aria-expanded="false"
                aria-controls="collapseTwo"
              >
                Шаблон XSLT
              </button>
            </h2>
          </div>
          <div
            id="collapseTwo"
            class="collapse"
            aria-labelledby="headingTwo"
            data-parent="#accordionExample"
          >
            <div class="card-body">
              <pre><code>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

    &lt;xsl:template match="/"&gt;
        &lt;html&gt;
            &lt;head&gt;
                &lt;title&gt;Задание №2&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;xsl:for-each select="root/графика"&gt;
                    &lt;xsl:variable name="idx" select="position() - 1"/&gt;

                    &lt;canvas 
                        id="canvas-{$idx}" 
                        width="{@ширина}" 
                        height="{@высота}"
                    &gt;&lt;/canvas&gt;

                    &lt;script&gt;
                        var canvas = document.getElementById("canvas-&lt;xsl:value-of select="$idx" /&gt;");
                        var context = canvas.getContext('2d')

                        &lt;xsl:for-each select="эллипс"&gt;
                            draw(
                                context, 
                                &lt;xsl:value-of select="@cx" /&gt;, 
                                &lt;xsl:value-of select="@cy" /&gt;, 
                                &lt;xsl:value-of select="@rx" /&gt;, 
                                &lt;xsl:value-of select="@ry" /&gt;, 
                                '&lt;xsl:value-of select="@ободок" /&gt;',
                                '&lt;xsl:value-of select="@заливка" /&gt;'
                            );
                        &lt;/xsl:for-each&gt;



                        function draw(ctx, cx, cy, rx, ry, stroke, fill) {
                            if(ctx.ellipse)
                            {
                                ctx.save();
                                ctx.beginPath();
                                ctx.ellipse(cx, cy, rx, ry, 0, 0, Math.PI*2);
                                ctx.strokeStyle=stroke;
                                ctx.stroke();
                                ctx.fillStyle=fill;
                                ctx.fill();     
                                ctx.restore();
                            }
                        }
                    &lt;/script&gt;
                        
                &lt;/xsl:for-each&gt;
            &lt;/body&gt;
        &lt;/html&gt;
    &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;
</code></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
